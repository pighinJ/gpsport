<%- include('../partials/head') %>

<section class="shop-container">
    <div class="product-grid">
        <% products.forEach(product => { %>
            <div class="product-grid__item">
                <div class="product-grid__imagen">
                    <img src="/image/<%= product.imagen %>" alt="<%= product.nombre_producto %>">
                </div>
                <div class="product-grid__info">
                    <h2 class="product-grid__name"><%= product.nombre_producto %></h2>
                    <p class="product-grid__price">$<%= product.precio_oferta %></p>
                    <button class="product-grid__btn btn-default" data-btn-action="add-btn-cart" data-modal="#jsModalCarrito">Agregar al Carrito</button>
                </div>
            </div>
        
    



    <!--MODAL CARRITO-->
<div class="modal" id="jsModalCarrito">
    <div class="modal__container">
        <button type="button" class="modal__close fa-solid fa-xmark jsModalClose "></button>

        <div class="modal__info">
            <div class="modal__header">
                <h2><i class="fa-brands fa-opencart"></i>Carrito</h2>
            </div>

            <div class="modal__body">
                <div class="modal__list">
                    
                        <div class="modal__item">
                            <div class="modal__thumb">
                                <img src="" alt="<%= product.nombre_producto %>">
                            </div>
                            <div class="modal__text-product">
                                <p><%= product.nombre_producto %></p>
                                <p><strong>$<%= product.precio_oferta %></strong></p>
                            </div>
                        </div>
                   
                </div>
            </div>

            <div class="modal__btns">
                <a href="#" class="btn-border">Ir al carrito</a>
                <a href="#" class="btn-primary">Comprar Ahora</a>
            </div>
        </div>
    </div>
</div>
<% }); %>
</div>
</section>



<%- include('../partials/footer') %>

<script>
    const addToCart = document.querySelectorAll('[data-btn-action="add-btn-cart"]');
    const closeModal = document.querySelector('.jsModalClose');

    addToCart.forEach(btn => {
        btn.addEventListener('click', (event) => {
            const nameModal = event.target.getAttribute('data-modal');
            const modal = document.querySelector(nameModal);

            //abrimos el modal
            modal.classList.add('active');
        });
    });

    //CERRAR EL MODAL
    closeModal.addEventListener('click', (event) => {
        event.target.parentNode.parentNode.classList.remove('active');
    });

    //CERRAMOS MODAL CUANDO HACEMOS CLICK FUERA DEL CONTENDINO DEL MODAL
    window.onclick = (event) => {
        const modal = document.querySelector('.modal.active');

        if (event.target == modal) {
            modal.classList.remove('active');
        }
    };
</script>
